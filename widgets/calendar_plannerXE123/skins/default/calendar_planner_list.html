<!--// XE ver.1.2.x 게시판을 이용한 플래너/음력달력 위젯 Calendar_list-----------------------
##
## @Package:    calendar_plannerXE123 (widget)
## @File name:	calendar_planner_list.html
## @Author:     Keysung Chung (keysung2004@gmail.com)
## @Copyright:  © 2009 Keysung Chung(keysung2004@gmail.com)
## @Contributors: Clements J. SONG (http://clements.kyunggi.ca/ , clements_song@hotmail.com)
## @Release:	under GPL-v2 License.
## @License:	http://www.opensource.org/licenses/gpl-2.0.php
##
## Redistribution and use in source and binary forms, with or without modification,
## are permitted provided that the following conditions are met:
##
## Redistributions of source code must retain the above copyright notice, this list of
## conditions and the following disclaimer.
## Redistributions in binary form must reproduce the above copyright notice, this list
## of conditions and the following disclaimer in the documentation and/or other materials
## provided with the distribution.
##
## Neither the name of the author nor the names of contributors may be used to endorse
## or promote products derived from this software without specific prior written permission.
##
## THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY
## EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
## MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE
## COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
## EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
## GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED
## AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
## NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
## OF THE POSSIBILITY OF SUCH DAMAGE.
##
## [author]
##  - Keysung Chung, 2009, 09, 01
##  - http://chungfamily.woweb.net/
## [changes]
##  - 위젯 PlannerXE123 ver. 5.6.0 : Keysung Chung, 2019, 01, 05
##  - 위젯 PlannerXE123 ver. 5.4.0 : Keysung Chung, 2017, 11, 20
##  - 위젯 PlannerXE123 ver. 5.3.0 : Keysung Chung, 2016, 10, 03
##  - 위젯 PlannerXE123 ver. 5.0.0 : Keysung Chung, 2015, 11, 05
##  - 위젯 PlannerXE123 ver. 4.8.0 : Keysung Chung, 2015, 11, 05
##  - 위젯 PlannerXE123 ver. 4.3.0 : Keysung Chung, 2014, 01, 01
##  - 위젯 PlannerXE123 ver. 4.1.0 : Keysung Chung, 2012, 04, 27
##  - 위젯 PlannerXE123 ver. 4.0.0 : Keysung Chung, 2011, 08, 01
##  - 위젯 PlannerXE123 ver. 3.7.0 : Keysung Chung, 2012, 03, 25
##  - 위젯 PlannerXE123 ver. 3.6.0 : Keysung Chung, 2011, 10, 20
##  - 위젯 PlannerXE123 ver. 3.5.0 : Keysung Chung, 2011, 10, 01
##  - 위젯 PlannerXE123 ver. 3.3.0 : Keysung Chung, 2010, 12, 12
##  - 위젯 PlannerXE123 ver. 3.1.0 : Keysung Chung, 2010, 10, 12
##  - 위젯 PlannerXE123 ver. 2.1.0 : Keysung Chung, 2010, 09, 13
##  - 위젯 PlannerXE123 ver. 2.0.0 : Keysung Chung, 2010, 09, 01
##  - 위젯 PlannerXE123 ver. 1.6.0 : Keysung Chung, 2010, 07, 01
##  - 위젯 PlannerXE123 ver. 1.3.0 : Keysung Chung, 2010, 05, 15
##  - 위젯 PlannerXE123 ver. 1.2.0 : Keysung Chung, 2010, 05, 01
##  - 위젯 PlannerXE123 ver. 1.1.0 : Keysung Chung, 2010, 04, 14
##  - 위젯 PlannerXE123 ver. 1.0.0 : Keysung Chung, 2010, 04, 01
##  - 위젯 PlannerXE123 ver. 0.2.2 : Keysung Chung, 2010, 01, 25
##  - PlannerXE123 ver. 0.2 : Keysung Chung, 2009, 11, 09
##	- PlannerXE123 ver. 0.1 : Keysung Chung, 2009, 07, 28
----------------------------------------------------------------------- -->
<!--{$widget_info->planner_version}-->
{@ print_r($widget_info->testfld)}
<!--@if(mobile::isFromMobilePhone())--><!--// 모바일스킨에서 jquery 작동을 위해 추가함: 모바일 디폴트 스킨 쓰기 앞부분임-->
{@ $ind_mobile = true; // mobile::isFromMobilePhone() 대신}
<!--@if(__XE_VERSION__ < "1.7.9")-->
{@
Context::addJsFile("./common/js/jquery.js", true, '', -100000);
Context::addJsFile("./common/js/js_app.js", true, '', -100000);
Context::addJsFile("./common/js/x.js", true, '', -100000);
Context::addJsFile("./common/js/common.js", true, '', -100000);
Context::addJsFile("./common/js/xml_handler.js", true, '', -100000);
Context::addJsFile("./common/js/xml_js_filter.js", true, '', -100000);
}
<!--@end-->
<!--@else-->
{@ $ind_mobile = false }
<!--@endif-->
<!--@if($offset == null && $widget_info->tz_apply == "Y")--><!--// 방문자 시간적용-->
{$html_temp = planner123_widget_main::fn_getClientOffsetTime()}
<!--@end-->
{@
$default_style = $widget_info->default_style; //디폴트스타일
$holiday_cnt_code = $widget_info->holiday_country_code; //휴일 국가
$country_name_arr = $widget_info->country_name_arr; //국가이름: id->이름
$linkpath = getUrl('','mid',$mid,'pGanjioption',1,'offset',$offset,'pHoliday_cnt',$holiday_cnt_code);//위젯, 게시판등 경로지정
$daylinkpath = getUrl('','mid',$widget_info->mid,'pGanjioption',1,'offset',$offset);
$skinpath = $tpl_path;
$xepath = $XE_path = getUrl('');
$widget_path = $widget_info->widget_path;
$arr_plan = null;// 클리어 하지 않으면 스킨의 일정내용이 같이 들어옴:(전역변수?)
$schedule_html = "";  //clear for time table
$ind_reservation = $widget_info->ind_reservation; // 위젯은 예약 적용 않음에서 메인게시판의 설정값으로 적용(V540).
$minStamp = $widget_info->minStamp; //입력허용 최소(V540)
$maxStamp = $widget_info->maxStamp; //입력허용 최대(V540)
$adjust_title_color = $widget_info->adjust_title_color; //일정제목 글자색 조정(V560)
}
<!--@if($widget_info->bg_color == null || $widget_info->bg_color == "transparent")-->
{@ $day_bgcolor="transparent";}<!--// 달력의 평일 칸 배경색 -->
<!--@else-->
{@ $day_bgcolor=$widget_info->bg_color;}<!--// 달력의 평일 칸 배경색 -->
<!--@end-->
<!--%import("./css/common.css")-->
<!--@if($colorset == "black")--><!--// 설정된 컬러셋의 종류에 따라서 css파일을 import 합니다 -->
<!--%import("./css/black.css")-->
<!--%import("./css/planner123_calendar_black.css")-->
<!--@else-->
<!--%import("./css/white.css")-->
<!--%import("./css/planner123_calendar_white.css")-->
<!--@end-->
<!--%import("xeicon2/xeicon.min.css")--><!--// V500: XEicon 2.0.0-->
{@ $theme_name = $widget_info->user_colorset;}
<!--@if($theme_name && file_exists($tpl_path.'colorset/'.$theme_name.'.css'))--><!--//theme css-->
{@ Context::addCSSFile($tpl_path.'colorset/'.$theme_name.'.css');}
<!--@end-->
<!--%import("./js/plannerXE123_widget.js")--><!--// planner123 js -->
<!--// 날자 설정 -------- -->
{@
$pOption_2 = $widget_info->pOption_2;// M=월 단위, W1,W2 =주단위 출력
$pTimeSchedule = $widget_info->pTimeSchedule;// 타임스케줄 테이블 출력
$ind_weekly_base = $widget_info->weekly_base; // 주단위 출력 옵션
$jd_dspStart = $widget_info->jd_dspStart; // 기간 시작일의 jd
$jd_dspEnd = $widget_info->jd_dspEnd; // 기간 종료일의 jd
$firstDayOfWeek = $widget_info->firstDayOfWeek; // 한주 시작요일(V500)
$today_stamp = $widget_info->TodayStamp;// 당일 타임스탬프(V540변경)
$todayYY = date("Y", $today_stamp);// 당일년도
$todayMM = date("n", $today_stamp);// 당일월
$todayDD = date("j", $today_stamp);// 당일일
$wrk_pTimestamp =$widget_info->pTimestamp; // 선택일자
$pYear = date("Y", $wrk_pTimestamp);
$pMonth = date("n", $wrk_pTimestamp);
$pDay = date("j", $wrk_pTimestamp);
$pMon = date("F", $wrk_pTimestamp);// 선택월 이름
$dispStart_stamp = $widget_info->dispStart_stamp;// 기간 시작
$dispStartYY = date("Y", $dispStart_stamp);// 출력 시작일 년도
$dispStartMM = date("m", $dispStart_stamp);
$dispStartDD = date("d", $dispStart_stamp);
$dispStartM = date("n", $dispStart_stamp);
$dispStart_date = $dispStartYY.",".$dispStartMM.",".$dispStartDD.",0,0,0";// 시간테이블을 위해
$dispEnd_stamp = $widget_info->dispEnd_stamp;//기간 종료
$dispEndYY = date("Y", $dispEnd_stamp);// 출력 종료일 년도
$dispEndMM = date("m", $dispEnd_stamp);
$dispEndDD = date("d", $dispEnd_stamp);
$dispEndM = date("n", $dispEnd_stamp);
$dispEnd_date = $dispEndYY.",".$dispEndMM.",".$dispEndDD.",23,59,59";// 시간테이블을 위해
$Calmain = planner123_widget_main::fn_CalMain($dispStart_stamp, $dispEnd_stamp, $firstDayOfWeek);// 달력일자, (V500)요일옵션추가
$HolidayByCountry = $widget_info->HolidayByCountry;// 휴일
$Memday = $widget_info->Memday_arr;// 기념일
$option_view_arr  = $widget_info->option_view_arr;// option에 따라 음력, 휴일, 기념일등 구하기
$count = count($option_view_arr);
// V430: 휴무일 추가와 관련하여 게시판별로 설정된 디폴트 국가의 휴일을 위젯에서도 게시판별로 반영해주도록 로직변경
$dft_country_code = $widget_info->dft_country_code; //위젯설정 국가ID(V430)
$dft_holiday = $HolidayByCountry[$dft_country_code]; //위젯설정 국가의 휴일 어레이(V430)
$dft_offday = $widget_info->dft_offday; //위젯설정 offday 요일등[h,0,1,2,3,4,5,6](V430)
$dft_offday_Label = $widget_info->ind_offday_label; //위젯설정 offday option: label(V430)
$dft_offday_naNew = $widget_info->ind_offday_naNew; //위젯설정 offday option: not allowe new event(V430)
$dft_holidayisoffday = $widget_info->ind_holidayisOffday; //위젯설정 offday option: 공휴일을 휴무일로(V430)
$dft_holidayisWorkday = $widget_info->ind_holidayisWorkday; //위젯설정 offday option: 공휴일을 근무일로(V540)
$board_country_arr = $widget_info->board_country_arr; // 게시판설정 국가ID(V430)
$board_offday_arr = $widget_info->board_offday_arr; // 게시판휴무일:srl->[h,0,1,2,3,4,5,6](V430)
$board_offday_option_arr= $widget_info->board_offday_option_arr; // 게시판휴무옵션:srl->[label,na_new](V430)
}
<!--@for($k = 0; $k < $count; $k++)-->
<!--@if($option_view_arr[$k] == "lunar_calendar")-->
{@
$ind_lunar_all = "";
$ind_lunar = "Y";
$Lunarday = planner123_widget_main::fn_sol2lun_kr_period($dispStart_stamp,$dispEnd_stamp);// 음력일자 2014-07-01 변경
}
<!--@elseif($option_view_arr[$k] == "week_number")-->
{@
$ind_week_number = "Y";// 몇주차
}
<!--@elseif($option_view_arr[$k] == "holiday")-->
{@
$ind_holiday = "Y";// 휴일
// $Holiday = planner123_widget_holiday::fn_HolidayChk($dispStart_stamp, $dispEnd_stamp);
}
<!--@elseif($option_view_arr[$k] == "memday")-->
{@
$ind_memday = "Y";// 기념일
// $Memday = planner123_widget_holiday::fn_MemdayChk($dispStart_stamp,$dispEnd_stamp);
}
<!--@elseif($option_view_arr[$k] == "solar_terms")-->
{@ $ind_24term = "Y";}
<!--@if($GanjiJeolki == null)-->
{@ $GanjiJeolki = planner123_widget_main::fn_jeolki_ganji_ary($dispStartYY,$dispStartM,$pGanjioption);}<!--// 간지절기 첫 년도--><!--// 주단위에서 다음년도 값중 절기는 의미 없으나 일진은 의미 있음-->
<!--@if($dispStartYY != $dispEndYY)--><!--// 년도 다를때는 1월부터-->
{@ $GanjiJeolki_2 = planner123_widget_main::fn_jeolki_ganji_ary($dispEndYY,1,$pGanjioption);}<!--// 간지절기 다음 년도-->
<!--@end-->
<!--@end-->
<!--@elseif($option_view_arr[$k] == "iljin")-->
{@ $ind_iljin = "Y";}
<!--@if($GanjiJeolki == null)-->
{@ $GanjiJeolki = planner123_widget_main::fn_jeolki_ganji_ary($dispStartYY,$dispStartM,$pGanjioption);}<!--// 간지절기 첫 년도-->
<!--@if($dispStartYY != $dispEndYY)--><!--// 년도 다를때는 1월부터-->
{@ $GanjiJeolki_2 = planner123_widget_main::fn_jeolki_ganji_ary($dispEndYY,1,$pGanjioption);}<!--// 간지절기 다음 년도-->
<!--@end-->
<!--@end-->
<!--@elseif($option_view_arr[$k] == "islamic")-->
{@
$ind_islamic_all = "";
$ind_islamic = "Y";
$Islamicday = planner123_widget_main::fn_getIslamic_ary($dispStart_stamp,$dispEnd_stamp);// 이슬람력일자
}
<!--@end-->
<!--@end-->
<!--@foreach($widget_info->document_list as $oDocument)--><!--// -----일정관련 확장변수, 내용등 지정 ----- -->
{@
$category_color = null;
$category_title = null;
$board_srl = $oDocument->get('module_srl');
$board_country_id =  $board_country_arr[$board_srl];
$board_holiday = $HolidayByCountry[$board_country_id];
$board_offday =  $board_offday_arr[$board_srl];
$board_offday_option =  $board_offday_option_arr[$board_srl];
}
<!--@if(in_array("NA_DISP", $board_offday_option))--><!--// 휴무일은 일정 출력 않음 옵션(V430)-->
{@ $board_offday_naDisp = TRUE;}
<!--@else-->
{@ $board_offday_naDisp = FALSE;}
<!--@end-->
<!--@if($board_offday_naDisp && in_array("H", $board_offday))--><!--// 공휴일 휴무 옵션(V430)-->
{@ $board_holidayisoffday = TRUE;}
<!--@else-->
{@ $board_holidayisoffday = FALSE;}
<!--@end-->
{@ $category_list = $widget_info->category_list;}
{@ $doc_category_srl = $oDocument->get('category_srl');}
<!--@if($doc_category_srl)--><!--// Category title & color값 얻기 -->
<!--@if($category_list[$doc_category_srl]->color)-->
{@ $category_color = $category_list[$doc_category_srl]->color;}
<!--@end-->
<!--@if($category_list[$doc_category_srl]->parent_srl > 0)--><!--// 부모 분류제목 추가 v530-->
{@ $parent_srl = $category_list[$doc_category_srl]->parent_srl;}
{@ $category_title = $category_list[$parent_srl]->title.'/'.$category_list[$doc_category_srl]->title;}
<!--@else-->
{@ $category_title = $category_list[$doc_category_srl]->title;}
<!--@end-->
<!--@end-->
<!--@if($oDocument->getCommentCount())-->
{@ $plan_reply = $oDocument->getCommentCount();}<!--// 댓글 숫자 얻기  -->
<!--@else-->
{@ $plan_reply = null;}
<!--@end-->
{@
$plan_start = $oDocument->getExtraValue(1);// 확장변수값 얻기
$plan_end = $oDocument->getExtraValue(2);
$plan_bgcolor = $oDocument->getExtraValueHTML(3);
$plan_flagicon = $oDocument->getExtraValueHTML(4);// , 로구분
$plan_repeat_cycle = $oDocument->getExtraValueHTML(5);
$plan_repeat_unit = $oDocument->getExtraValueHTML(6);
$plan_time = $oDocument->getExtraValueHTML(7);// , 로구분
$plan_title  = $oDocument->getTitle($widget_info->subject_cut_size);
$plan_detail = $oDocument->getContentText($widget_info->content_cut_size);//일정내용
$plan_detail = str_replace("\r\n\r\n", "\r\n", $plan_detail);
$plan_detail = str_replace("\n\n", "\r\n", $plan_detail);
}
<!--@if($oDocument->image_diary && !$ind_mobile)--><!--// 그림일기 위해 추가 -->
{@
$thumnail_arr = explode(",",$oDocument->image_diary);
$plan_img = $oDocument->getThumbnail($thumnail_arr[1],$thumnail_arr[2],$thumnail_arr[3]);
$ind_image_diary = $thumnail_arr[0];
}
<!--@else-->
{@
$plan_img = null;
$ind_image_diary = null;
}
<!--@end-->
{@
$plan_doc_extra_vars = $oDocument->get('extra_vars');// 취소일정을 위해 추가
$ind_complete_doc = $oDocument->display_complete_doc;// 취소일정을 위해 추가 보드스킨의 완료일정 출력여부
$plan_docsrl = $oDocument->document_srl;
$plan_url = getUrl('document_srl',$plan_docsrl,'offset',$offset);
$plan_board_skin = $oDocument->module_skin;
$plan_use_category_bgcolor = $oDocument->use_category_bgcolor;
$plan_new = $oDocument->printExtraImages($widget_info->duration_new);
}
<!--@if($widget_info->display_detail == "F")-->
{@ $plan_detail_all[$plan_docsrl] = $oDocument->getContent(false); // V430 }
<!--@end-->
<!--@if($plan_end == null )-->
{@ $plan_end = $plan_start;}
<!--@end-->
{@
$plnstartYY = substr($plan_start,0,4);
$plnstartMM = substr($plan_start,4,2);
$plnstartDD = substr($plan_start,6,2);
$plnstartMM = ltrim( $plnstartMM, "0" );//  앞의 "0" 제거
$plnstartDD = ltrim( $plnstartDD, "0" );//  앞의 "0" 제거
$plnendYY = substr($plan_end,0,4);
$plnendMM = substr($plan_end,4,2);
$plnendDD = substr($plan_end,6,2);
$plnendMM = ltrim( $plnendMM, "0" );// 일자 앞의 "0" 제거
$plnendDD = ltrim( $plnendDD, "0" );// 일자 앞의 "0" 제거
}
<!--@if($plnstartYY != null)--><!--// qtip 미사용으로 인해 아래 3째줄 주석처리-->
{@ $plan_detail = str_replace("'", "&#39;", $plan_detail);}<!--// '을 &#39;로 대체 textbox보이기위해-->
{@ $plan_detail = str_replace("\"", "&quot;", $plan_detail);}<!--// "를 &quot;로 대체 textbox보이기위해-->
<!--@if($plan_doc_extra_vars == 'A' || $plan_doc_extra_vars == 'F' || $plan_doc_extra_vars == 'R')-->
{@ $_doc_status = $plan_doc_extra_vars;}<!--// 취소일정위해 추가 ('A'=>'기본', 'F'=>'완료', 'R'=>'취소');  // 기본: 최초는 null, 수정하면 A. (v430: XEV174부터 serialize 않음)-->
<!--@else-->
{@ $_doc_status = unserialize($plan_doc_extra_vars);}<!--// XEV174이전 호환을 위해-->
<!--@end-->
<!--@if($_doc_status == "F" && ($ind_complete_doc == "L" || $ind_complete_doc == "C"))-->
{@ $plan_title = "<span class='complete'>".$plan_title."</span>";}<!--// 완료일정 제목에 취소선 긋기-->
<!--@end-->
<!--@if($_doc_status != "R" && ($ind_complete_doc == "N" && $_doc_status != "F" || $ind_complete_doc != "N") )--><!--// 취소일정이 아닐때 처리-->
{@ $arr_repeat = planner123_widget_main::fn_repeat_schedule($dispStart_stamp, $dispEnd_stamp, $plan_start, $plan_end, $plan_repeat_cycle, $plan_repeat_unit, $board_holiday); //V410: 휴일추가, V430:board별 휴일 ;}
<!--@foreach($arr_repeat as $i => $val_1)-->
<!--@foreach($val_1 as $j => $val_2)-->
<!--@if($arr_repeat[$i][$j])--><!--//년도 들어옴 V400--><!--// 리스트형은 일별로 출력됨-->
{@ $tmp_offday = FALSE;}
{@ $ind_weekday = date('w', mktime(0, 0, 0, $i, $j, $arr_repeat[$i][$j])); // 당일요일}
<!--@if($board_offday_naDisp)--><!--// 휴무일 출력않음(보드별). V430-->
{@ $tmp_offday = in_array(strval($ind_weekday), $board_offday); // 당일 board 휴뮤요일여부}
<!--@if(!$tmp_offday && $board_holidayisoffday)-->
{@ if($board_holiday[$i][$j] != null) $tmp_offday = TRUE; // 당일 board 공휴일여부}
<!--@end-->
<!--@end-->
<!--@if($tmp_offday == FALSE)--><!--// 휴무일이 아니면 output-->
{@ $plan_length = 1;}
<!--@if($arr_plan[$i][$j])--><!--// 비어있지 않으면 일정 구분자(1차분리자) 추가-->
{@ $arr_plan[$i][$j] .="|#&Oslash;#|";}
<!--@end-->
{@ $arr_plan[$i][$j] .= $plan_title."|&Oslash;|".$plan_url."|&Oslash;|".$plan_detail."|&Oslash;|".$plan_bgcolor."|&Oslash;|".$plan_flagicon."|&Oslash;|".$category_title."|&Oslash;|".$category_color."|&Oslash;|".$plan_reply."|&Oslash;|".$plan_time."|&Oslash;|".$plan_board_skin."|&Oslash;|".$plan_use_category_bgcolor."|&Oslash;|".$plan_new."|&Oslash;|".$plan_img."|&Oslash;|".$ind_image_diary."|&Oslash;|".$plan_length."|&Oslash;|".$plan_docsrl."|&Oslash;|".$plan_start."|&Oslash;|".$plan_end."|&Oslash;|".$_doc_status;}<!--// 어레이에 추가 1차분리자= "|#&Oslash;#|", 2차 분리자 "|&Oslash;|"-->
{@ $j_temp = ""; // 일정 시작일 지움}
<!--@end-->
<!--@end--><!--// "$arr_repeat[$i][$j]" 끝 -->
<!--@end--><!--// foreach 끝 -->
<!--@end--><!--// foreach 끝 -->
<!--@end--><!--// 취소일정이 아닐때 처리 끝-->
<!--@end--><!--// if($plnstartYY != null ) 끝-->
<!--@end--><!--// foreach($widget_info->document_list as $oDocument) 끝-->
<div id='{$default_style}_planner123' class="planner123">
<!--@if($widget_info->title)--><!--// planner title -->
<div class="boardHeader"><div class="boardHeaderBorder"><h2>
{$widget_info->title}
</h2></div></div>
<!--@end-->
<!--@if($theme_name && file_exists($tpl_path.'colorset/'.$theme_name.'.html'))--><!--//theme header-->
{@ $oTemplate = &TemplateHandler::getInstance();}
{@ print $oTemplate->compile($tpl_path.'colorset/', $theme_name.'.html');}
<!--@else-->
<!--#include("./_header_planner.html")-->
<!--@end-->
<table class="planner_list" summary="PlannerXE123"><!--//  달력 -->
<thead>
<tr>
<th scope='col' width='18%'><div class='wd_border'><div class='wd_title'>Date</div></div></th>
<th scope='col' width='*'><div class='wd_border'><div class='wd_title'>Schedule</div></div></th>
<th scope='col' width='15%'><div class='wd_border'><div class='wd_title'>Note</div></div></th>
</tr>
</thead>
<tbody>
{@ $weekcount = count($Calmain);}
<!--@for($i=0; $i<$weekcount; $i++)-->
<!--@for($j=0; $j<7; $j++)-->
<!--@if($Calmain[$i][$j]== "*")--><!--//  달력상의 빈날 제외-->
{@ $Calmain[$i][$j]=null;}
<!--@else--><!--//  달력상 날자 있으면-->
{@
$wrk_tmp_arr= explode("-",$Calmain[$i][$j]);// YYYY-M-d
$Calmain_YY = $wrk_tmp_arr[0];
$Calmain_MM = $wrk_tmp_arr[1];
$Calmain_DD = $wrk_tmp_arr[2];
$Calmain_yymmdd = $Calmain_YY.$Calmain_MM.$Calmain_DD;
$today_yymmdd = $todayYY.$todayMM.$todayDD;
}
<!--@if($Calmain_yymmdd == $today_yymmdd)-->
<tr class="today_bgcolor"><!--// 당일-->
<!--@else-->
<!--@if($i%2)-->
<tr class="week_one">
<!--@else-->
<tr><!--//스킨관리의 배경색 설정은 생략함-->
<!--@end-->
<!--@end-->
{@ $tmparr_lunar=explode(",",$Lunarday[$Calmain_MM][$Calmain_DD]);//음력날자(2014-07-01 "-"를 ","로변경) }
<!--@if($tmparr_lunar[3] == "윤달")-->{@ $youndal = "윤";}<!--@else-->{@ $youndal = null;}<!--@end-->
{@
$tmpfld_lunar ="(".$youndal.$tmparr_lunar[1]."-".$tmparr_lunar[2].")";
$tmparr_islam=explode("-",$Islamicday[$Calmain_MM][$Calmain_DD]);
$tmpfld_islamicday ="(".$tmparr_islam[1]."-".$tmparr_islam[2].")";//이슬람력날자
$tmparr4=explode("-",$HolidayByCountry[$holiday_cnt_code][$Calmain_MM][$Calmain_DD]);// 공휴일: v430 변경
$tmparr5=explode("-",$Memday[$Calmain_MM][$Calmain_DD]);// 기념일
$tmparr6=explode("|#&Oslash;#|",$arr_plan[$Calmain_MM][$Calmain_DD]);// 일정/플랜  1차 "|#&Oslash;#|",로 분리
}
<!--@if($Calmain_YY == $dispStartYY)-->
{@ $tmparr2=explode("-",$GanjiJeolki[$Calmain_MM][$Calmain_DD]);}<!--//24절기-->
<!--@else-->
{@ $tmparr2=explode("-",$GanjiJeolki_2[$Calmain_MM][$Calmain_DD]);}<!--//24절기 후년-->
<!--@end-->
<!--@if(($j==0 || $Calmain_DD==1) && ($pOption_2 == 'W1' || $pOption_2 == 'W2' || $ind_weekly_base > 0))-->
{@ $tmp_dsp_mmdd = $Calmain_MM."/".$Calmain_DD;}
<!--@else-->
{@ $tmp_dsp_mmdd = $Calmain_DD;}
<!--@end-->
{@ $WDay_seq = ($firstDayOfWeek + $j) % 7;}<!--// 요일위치 조정(V500)-->
<!--@if($WDay_seq==1 && $ind_week_number =='Y')-->
{@ $tmp_weekNo = "(".date("W", strtotime($Calmain[$i][$j])).") "; //몇주차 }
{@ $wrkfld_weekNo = "<span class='week_no'>".$tmp_weekNo."</span>";}
<!--@else-->
{@ $wrkfld_weekNo = "";}
<!--@end-->
<!--@if($WDay_seq==0 || $tmparr4[0] != null)-->
{@ $wrkfld_dt = "<span class='holiday strong font_big'>".$tmp_dsp_mmdd."</span>";}<!--// 일요일 및 휴일-->
<!--@elseif($WDay_seq==6)-->
{@ $wrkfld_dt = "<span class='saturday strong font_big'>".$tmp_dsp_mmdd."</span>";}<!--// 토요일-->
<!--@else-->
{@ $wrkfld_dt = "<span class='weekday strong font_big'>".$tmp_dsp_mmdd."</span>";}<!--// 평일-->
<!--@end-->
<!--@if($ind_lunar_all == 'Y' && $Calmain_DD != null)-->
{@ $wrkfld_lunar = "<span class='lunar'>".$tmpfld_lunar."</span>";}<!--// 음력 - 모든날자 표시-->
<!--@elseif($ind_lunar == 'Y' && ($tmparr_lunar[2] == 1 || $tmparr_lunar[2] == 10 || $tmparr_lunar[2] == 15 || $tmparr_lunar[2] == 20))-->
{@ $wrkfld_lunar = "<span class='lunar'>".$tmpfld_lunar."</span>";}<!--// 음력 - 1,10,15,20일 표시-->
<!--@else-->
{@ $wrkfld_lunar = '';}
<!--@end-->
<!--@if($ind_islamic_all == 'Y' && $Calmain_DD != null)-->
{@ $wrkfld_islam = "<span class='islamic'>".$tmpfld_islamicday."</span>";}<!--// 이슬람력 - 모든날자 표시-->
<!--@elseif($ind_islamic == 'Y' && ($tmparr_islam[2] == 1 || $tmparr_islam[2] == 10 || $tmparr_islam[2] == 15 || $tmparr_islam[2] == 20))-->
{@ $wrkfld_islam = "<span class='islamic'>".$tmpfld_islamicday."</span>";}<!--// 이슬람력 - 1,10,15,20일 표시-->
<!--@else-->
{@ $wrkfld_islam = '';}
<!--@end-->
<!--@if($ind_24term == 'Y')--><!--// 절기 표시-->
{@ $wrkfld_24term = "<span class='seasons24 strong'> ".$tmparr2[4]."</span>";}<!--// 절기-->
<!--@end-->
<!--@if($ind_iljin == 'Y')--><!--// 일진 표시-->
{@ $wrkfld_iljin = "<span class='lunar'>".substr($tmparr2[2], 0, 6)."</span>";}<!--// 일진-->
<!--@end-->
<!--@if($ind_holiday == 'Y' && $tmparr4[0] != null)-->
{@ $wrkfld_holiday = "<span class='holiday strong'>".$tmparr4[0]."</span>";}<!--// 공휴일-->
<!--@else-->
{@ $wrkfld_holiday = '';}
<!--@end-->
{@ $weekDayTitle_arr = explode(",", $lang->pln_calendar_header); //요일 이름(V500) }
<!--@if($WDay_seq==0)-->
{@ $wrkfld_wd_name = "<span class='holiday'>".$weekDayTitle_arr[$WDay_seq]."</span>";}<!--//일요일이름-->
<!--@elseif($WDay_seq==6)-->
{@ $wrkfld_wd_name = "<span class='saturday'>".$weekDayTitle_arr[$WDay_seq]."</span>";}<!--//토요일이름-->
<!--@else-->
{@ $wrkfld_wd_name = "<span class='weekday'>".$weekDayTitle_arr[$WDay_seq]."</span>";}<!--//평일이름-->
<!--@end-->
{@ $is_offday = FALSE; // clear}
<!--@if($dft_offday_naNew || $dft_offday_Label)--><!--// 휴무일 신규금지및 휴무일표시V430-->
{@ $is_offday = in_array(strval($WDay_seq), $dft_offday); // $j(순서)를 $WDay_seq(요일)로 변경(V500) }
<!--@if(!$is_offday && $dft_holidayisoffday)-->
{@ if($dft_holiday[$Calmain_MM][$Calmain_DD] != "") $is_offday = TRUE; //default holiday}
<!--@end-->
<!--@if($is_offday && $dft_holidayisWorkday)--><!--// '공휴일을 근무일로 처리' 옵션추가(V540)-->
{@ if($dft_holiday[$Calmain_MM][$Calmain_DD] != "") $is_offday = FALSE; }
<!--@end-->
<!--@end-->
{@ $procDayStamp = mktime(0,0,0,$Calmain_MM,$Calmain_DD,$Calmain_YY);}
<!--@if($resv_status_arr[$Calmain_MM][$Calmain_DD] == 'full')--><!--// 위젯적용않음: 항상 false -->
{@ $is_resv_full = true; //모두예약완료(V530)}
<!--@else-->
{@ $is_resv_full = false;}
<!--@end-->
<!--@if($minStamp && $procDayStamp < $minStamp)-->
{@ $over_min_period = true; //입력허용기간 초과(V540)}
<!--@else-->
<!--@if($ind_reservation != 'N' && $procDayStamp < $today_stamp)-->
{@ $over_min_period = true; //예약일정시 과거일자는 최소기간 범위외로...(V540)}
<!--@else-->
{@ $over_min_period = false;}
<!--@end-->
<!--@end-->
<!--@if($maxStamp && $procDayStamp > $maxStamp)-->
{@ $over_max_period = true; //입력허용기간 초과(V540)}
<!--@else-->
{@ $over_max_period = false;}
<!--@end-->
{@ $wrkfld_btn = '';}
<!--@if($dft_offday_naNew && $is_offday)--><!--// 휴무일 신규금지면-->
{@ $date_tooltip = ' title='.$lang->pln_off_day.' ';}
<!--@elseif($over_min_period || $over_max_period)--><!--// 입력허용기간범위외(V540)-->
{@ $date_tooltip = ' title='.$lang->pln_input_not_allow.' ';}
<!--@else-->
<!--@if($ind_reservation != 'N' && $widget_info->display_resv_btn != 'N')--><!--// 예약버튼-->
<!--@if($is_resv_full)--><!--//모두예약완료--><!--// 위젯은 적용않음: 항상 false -->
{@ $wrkfld_btn = ' '.$lang->pln_closed_resv2;}
{@ $date_tooltip = ' title='.$lang->pln_closed_resv2.' ';}
<!--@else-->
{@ $wrkfld_btn = ' <button title="'.$lang->pln_resv2.'" type="button" class="button3"> <span>'.$lang->pln_resv.'</span></button>';}
{@ $date_tooltip = ' title='.$lang->pln_resv2.' ';}
<!--@end-->
<!--@else-->
{@ $date_tooltip = ' title='.$lang->pln_write.' ';}
<!--@end-->
<!--@end-->
{@ $wrkfld_link = '';}
<!--@if($over_min_period || $over_max_period || $is_resv_full || $is_offday && $dft_offday_naNew)-->
<!--// 입력허용기간범위외(예약일정시과거일자포함)(V540), 예약마감, 휴무일&신규금지는 링크없이.-->
{@ $wrkfld_link = "<a href='#' class='strong past_day'>".$wrkfld_weekNo.$wrkfld_dt." ".$wrkfld_wd_name."</a>";}
<!--@else-->
{@
$wrkfld_url = $daylinkpath."&amp;act=dispBoardWrite";// 일자 클릭시 쓰기로 이동
$wrkfld_url .= "&amp;extra_vars1=".$Calmain_YY.substr("0".$Calmain_MM,-2).substr("0".$Calmain_DD,-2);// 일정시작 확장변수 값
}
<!--@if($Calmain_MM != $pMonth && $widget_info->ind_fill == 'Y' && $pOption_2 == 'M')--><!--//월이다르면 반투명-->
{@ $wrkfld_class = ' diff_month';}
<!--@else-->
{@ $wrkfld_class = '';}
<!--@end-->
{@ $wrkfld_link = "<a href=".$wrkfld_url." class='strong link_allow " .$wrkfld_class."'>" .$wrkfld_weekNo.$wrkfld_dt."&nbsp;".$wrkfld_wd_name."&nbsp;".$wrkfld_btn."</a>";}
<!--@end-->
{@ $outtext = "<ul><li class='date_label' ".$date_tooltip. ">".$wrkfld_link."</li>"
."<li class='date_label2'>".$wrkfld_lunar.$wrkfld_islam.$wrkfld_iljin.$wrkfld_24term.$wrkfld_holiday."</li></ul>";}<!--// 첫칸-->
<td>{@ echo $outtext}</td><!--// 첫칸 출력(V560)-->
{@ $outtext = null;}
<!--@if(!empty($tmparr6[0]))--><!--// 두째칸(일정/플랜) -->
<!--@foreach($tmparr6 as $val)-->
{@ $tmparr7=explode("|&Oslash;|",$val);}<!--// 일정/플랜  2차 "|&Oslash;|",로 분리-->
<!--@if(!empty($tmparr7[0]))--><!--// 일정 있으면-->
{@ $_doc_status = $tmparr7[18];}
{@ $lplan_state = null;}
<!--@if(!empty($tmparr7[4]))-->
{@ $arr_icon = explode(",",$tmparr7[4]);}
<!--@foreach($arr_icon as $icon)-->
<!--@if($icon = trim($icon))-->
<!--@if(file_exists($skinpath."images/icon/".$icon))-->
{@ $icon_folder = "";}
<!--@elseif(file_exists($skinpath."images/icon/client/".$icon))-->
{@ $icon_folder = "client/";}
<!--@elseif(file_exists($skinpath."images/icon/manager/".$icon))-->
{@ $icon_folder = "manager/";}
<!--@end-->
{@ $lplan_state .= "<img src='".$skinpath."images/icon/".$icon_folder.$icon."'/>";}<!--//일정확인-->
<!--@end-->
<!--@end-->
<!--@end-->
{@
$tmp_arr=explode(",",$tmparr7[10]);// 카테고리사용여부 및 색상적용옵션: v530 일부조정
$ind_use_category = $tmp_arr[0];// board 의 카테고리 사용여부
$ind_bgcolor_option = $tmp_arr[1];// board 의 카테고리 배경색 사용옵션
$ind_display_category = $tmp_arr[2];// board 의 카테고리명 출력여부
$ind_display_selectedtime = $tmp_arr[3];// board 의 선택시간 출력여부
}
<!--@if($ind_use_category == 'Y' && $ind_display_category == 'Y')--><!--// v530 옵션추가-->
<!--@if($ind_bgcolor_option == "category_bg")--><!--// 분류색상을->배경색으로인 경우-->
{@ $tmp_color_chr = '';}
<!--@else-->
{@ //$tmp_color_chr = $tmparr7[6]; //분류색적용 불필요할듯...}
{@ $tmp_color_chr = '';}
<!--@end-->
<!--@if(!empty($tmparr7[5]))-->
<!--@if($_doc_status == "F" && ($ind_complete_doc == "L" || $ind_complete_doc == "C"))-->
{@ $lplan_cat = "<span class='complete' style='color:".$tmp_color_chr.";'>[".$tmparr7[5]."] </span>";}<!--//완료일정 분류에 취소선 긋기 V540-->
<!--@else-->
{@ $lplan_cat = "[".$tmparr7[5]."]";}<!--//분류-->
<!--@end-->
<!--@end-->
<!--@else-->
{@ $lplan_cat = "";}
<!--@end-->
<!--@if(!$tmparr7[8])--><!--//시간표시-->
{@
$title_time = null;// 제목에표시할 시간값
$time_start =null;// 일정 시작시간
$time_end = null;// 일정 종료시간
$time_disply_fld = null;// 툴팁에표시할 시간값
$tmp_time = null;
}
<!--@else-->
{@ $tmp_time = explode(",",$tmparr7[8]);}
<!--@if($ind_reservation == "T")--><!--// 예약(시간) 단, 위젯은 항상 중복 허용"N"-->
{@
$title_time = $tmp_time[0]." ";
$time_start = $tmp_time[0];
$time_end = trim($tmp_time[count($tmp_time)-1]);
$time_disply_fld = "[".$tmparr7[8]."]&#x0A;";//선택내용 전부
}
<!--@else--><!--// 중복허용 -->
{@
$title_time = $tmp_time[0]." ";
$time_start = $tmp_time[0];
$time_end = trim($tmp_time[count($tmp_time)-1]);
}
<!--@if($time_start && $time_start == $time_end)-->
{@ $time_disply_fld = "[".$time_start."-"."] ";}
<!--@else-->
{@ $time_disply_fld = "[".$time_start."-".$time_end."] ";}
<!--@end-->
<!--@end-->
<!--@if($_doc_status == "F" && ($ind_complete_doc == "L" || $ind_complete_doc == "C"))-->
{@ $title_time = "<span class='complete'>".$title_time."</span>";}<!--//완료일정 시간에 취소선 긋기 V540-->
<!--@end-->
<!--@end--><!--//시간표시-->
<!--@if($ind_display_selectedtime == "N")--><!--// 일정제목에 시간 제거 v530-->
{@ $title_time = null;// 시간값 제거}
<!--@end-->
<!--@if(!empty($tmparr7[7]))--><!--//댓글숫자-->
{@ $lplan_reply ="<span class='small'>[".$tmparr7[7]."]</span>";}
<!--@else-->
{@ $lplan_reply =null;}
<!--@end-->
<!--@if($widget_info->display_tooltip == "all" || $widget_info->display_tooltip == "")--><!--// 툴팁표시조건 -->
{@ $tooltip_desc = $time_disply_fld.$tmparr7[2];}
<!--@elseif($widget_info->display_tooltip == "log" && $is_logged)-->
{@ $tooltip_desc = $time_disply_fld.$tmparr7[2];}
<!--@elseif($widget_info->display_tooltip == "adm" && $grant->is_admin)-->
{@ $tooltip_desc = $time_disply_fld.$tmparr7[2];}
<!--@end--><!--//툴팁표시조건-->
{@ $title_disp = $tmparr7[0];}<!--// 출력될 일정 제목-->
<!--@if($ind_bgcolor_option == "picker_bg")--><!--// 선택색상을->배경색-->
<!--@if($_doc_status == "F" && $ind_complete_doc == "C")-->
{@ $tmparr7[3] = "transparent";}
<!--@end-->
{@
$tmp_style = "style='clear:both; background-color:".$tmparr7[3]."; '";
$tmp_style1_0 = "style='float:left; background-color:".$tmparr7[3]."; '";
$tmp_style1_1 = "style='padding:5px 0 0 5px; background-color:".$tmparr7[3]."; border:medium double  #FFFFFF;'";
$tmp_style2 = "style='background-color:".$tmparr7[3].";'";
}
<!--@elseif($ind_bgcolor_option == "picker_text")--><!--// 선택색상을->글자색-->
{@
$tmp_style = "style='clear:both; color:".$tmparr7[3]."; '";
$tmp_style1_0 = "style='float:left; color:".$tmparr7[3]."; '";
$tmp_style1_1 = "style='padding:5px 0 0 5px; color:".$tmparr7[3]."; border:medium double ".$tmparr7[3].";'";
$tmp_style2 = "style='color:".$tmparr7[3].";'";
}
<!--@elseif($ind_bgcolor_option == "category_bg" && $ind_use_category == "Y")--><!--// 분류색상을->배경색-->
<!--@if($_doc_status == "F" && $ind_complete_doc == "C")-->
{@ $tmparr7[6] = "transparent";}
<!--@end-->
{@
$fontcolor = ''; //(V540에서 whitesmoke 제거)
$tmp_style = "style='clear:both; color:".$fontcolor."; background-color:".$tmparr7[6]."; '";
$tmp_style1_0 = "style='float:left; color".$fontcolor."; background-color:".$tmparr7[6]."; '";
$tmp_style1_1 = "style='padding:5px 0 0 5px; color:".$fontcolor."; background-color:".$tmparr7[6]."; border:medium double #FFFFFF;'";
$tmp_style2 = "style='color:".$fontcolor."; background-color:".$tmparr7[6].";'";
}
<!--@elseif($ind_bgcolor_option == "category_text" && $ind_use_category == "Y")--><!--// 분류색상을->글자색-->
{@
$tmp_style = "style='clear:both; color:".$tmparr7[6]."; '";
$tmp_style1_0 = "style='float:left; color:".$tmparr7[6]."; '";
$tmp_style1_1 = "style='padding:5px 0 0 5px; color:".$tmparr7[6]."; border:medium double ".$tmparr7[6].";'";
$tmp_style2 = "style='color:".$tmparr7[6].";'";
}
<!--@else--><!--// 기본은 선택색상->배경색-->
<!--@if($_doc_status == "F" && $ind_complete_doc == "C")-->
{@ $tmparr7[3] = "transparent";}
<!--@end-->
{@
$tmp_style = "style='clear:both; background-color:".$tmparr7[3]."; '";
$tmp_style1_0 = "style='float:left; background-color:".$tmparr7[3]."; '";
$tmp_style1_1 = "style='padding:5px 0 0 5px; background-color:".$tmparr7[3]."; border:medium double  #FFFFFF;'";
$tmp_style2 = "style='background-color:".$tmparr7[3].";'";
}
<!--@end-->
<!--@if($tmparr7[13] == "Y" && !empty($tmparr7[12]))--><!--//시간+일정제목-->
{@ $schedule_link_text = "<a class='schedule_view' ".$tmp_style2." href='".$tmparr7[1]."' title='".$tooltip_desc."'><img class='clear_line' style='float:left;' src='".$tmparr7[12]."'/>&nbsp;".$title_time.$title_disp."&nbsp;".$lplan_cat.$lplan_state.$lplan_reply.$tmparr7[11]."</a><div class='clear_line schedule_bottom'></div>";}
<!--@elseif($tmparr7[13] == "F" && !empty($tmparr7[12]))-->
{@ $schedule_link_text = "<a class='schedule_view' ".$tmp_style2." href='".$tmparr7[1]."' title='".$tooltip_desc."'><img class='clear_line' style='float:left;' src='".$tmparr7[12]."'/>&nbsp;".$title_time.$title_disp."&nbsp;".$lplan_cat.$lplan_state.$lplan_reply.$tmparr7[11]."</a><div class='clear_line schedule_bottom'></div>";}
<!--@else-->
{@ $schedule_link_text = "<a class='schedule_view' ".$tmp_style2." href='".$tmparr7[1]."' title='".$tooltip_desc."'>&nbsp;".$title_time.$title_disp."&nbsp;".$lplan_cat.$lplan_state.$lplan_reply.$tmparr7[11]."</a><div class='clear_line schedule_bottom'></div>";}
<!--@end-->
{@ $out_text = "<div class='schedule_view_div $blink_class'>".$schedule_link_text."</div>";}
<!--@if($widget_info->display_detail == "Y")--><!--// 두째칸(일정/플랜)detail 출력을 위해...-->
{@ $out_html .= $out_text."<div style='padding-left:10px;'>".$tmparr7[2]."</div></br>";}
<!--@elseif($widget_info->display_detail == "F")-->
{@ $out_html .= $out_text."<div style='padding-left:10px;'>".$plan_detail_all[$tmparr7[15]]."</div></br>";}
<!--@else-->
{@ $out_html .= $out_text;}<!--// 두째칸(일정/플랜)출력-->
<!--@end-->
{@ $temp_html = $schedule_link_text;}
{@ $schedule_process = "js";}<!--//time table 출력을 위해 일정자료 JS로 넘길 어레이 작성-->
<!--@if( $schedule_process =="js" && ($pOption_2 == 'W1' || $pOption_2 == 'W2') )-->
{@
$segtype = "a";
$schedule_html[$count_seg]['week'] = $i;
$schedule_html[$count_seg]['weekday'] = $j;
$schedule_html[$count_seg]['yymmdd'] = $Calmain[$i][$j];
$schedule_html[$count_seg]['month'] = $Calmain_MM;
$schedule_html[$count_seg]['date'] = $Calmain_DD;
$schedule_html[$count_seg]['revseq'] = 7-$tmparr7[14];
$schedule_html[$count_seg]['segtype'] = $segtype;
$schedule_html[$count_seg]['length'] = $tmparr7[14];
$schedule_html[$count_seg]['image'] = $tmparr7[12];
$schedule_html[$count_seg]['pln_srl'] = $tmparr7[15];
$schedule_html[$count_seg]['pln_start'] = $tmparr7[16];
$schedule_html[$count_seg]['pln_end'] = $tmparr7[17];
$schedule_html[$count_seg]['pln_stime'] = $time_start;
$schedule_html[$count_seg]['pln_etime'] = $time_end;
$schedule_html[$count_seg]['html'] = $temp_html;
$count_seg += 1;
}
<!--@end-->
<!--@end--><!--// end if 일정 있으면 끝-->
<!--@end--><!--// end foreach($tmparr6 as $val)-->
<!--@end--><!--// end if(!empty($tmparr6[0])-->
<!--@if($is_offday && $dft_offday_Label)--><!--// 휴무일표시(V430)-->
{@ $out_html .= "<div class='offday strong'>".$lang->pln_off_day."</div>";}<!--//휴뮤일표시-->
<!--@end-->
{@ $ind_ua = planner123_widget_main::fn_get_USER_AGENT();}
<!--@if(($ind_ua == "IE6" || $ind_ua == "IE7") && $Calmain_yymmdd == $today_yymmdd)-->
<td class = 'plan today_border'>{@ echo $out_html}</td><!--// 일정 출력(V560)-->
<!--@else-->
<td class = 'plan'>{@ echo $out_html}</td><!--// 일정 출력(V560)-->
<!--@end-->
{@ $out_html = null;}
{@ $holiday_process = "js";}<!--// ""는 직접처리 "js"는 jquery에서 처리-->
<!--@if($ind_holiday == 'Y' && $tmparr4[0])--><!--//time table 출력을 위해 휴일 자료 JS로 넘길 어레이 작성-->
{@ $temp_html = "<div class='holiday strong'>".$tmparr4[0]."</div>";}<!--// 공휴일-->
<!--@if( $holiday_process =="js" && ($pOption_2 == 'W1' || $pOption_2 == 'W2') )-->
{@
$schedule_html[$count_seg]['week'] = $i;
$schedule_html[$count_seg]['weekday'] = $j;
$schedule_html[$count_seg]['yymmdd'] = $Calmain[$i][$j];
$schedule_html[$count_seg]['month'] = $Calmain_MM;
$schedule_html[$count_seg]['date'] = $Calmain_DD;
$schedule_html[$count_seg]['revseq'] = 6;
$schedule_html[$count_seg]['segtype'] ="b";
$schedule_html[$count_seg]['length'] = 1;
$schedule_html[$count_seg]['image'] = "";
$schedule_html[$count_seg]['pln_srl'] = "";
$schedule_html[$count_seg]['pln_start'] = "";
$schedule_html[$count_seg]['pln_end'] = "";
$schedule_html[$count_seg]['pln_stime'] = "";
$schedule_html[$count_seg]['pln_etime'] = "";
$schedule_html[$count_seg]['html'] = $temp_html;
$count_seg += 1;
}
<!--@end-->
<!--@end-->
<!--@if($ind_memday == 'Y' && !empty($tmparr5[0]))--><!--// 셋째칸 두째줄(기념일) -->
{@ $out_html = "<li><span class='memorial'>".$tmparr5[0]."</span></li>";}<!--// 기념일-->
<!--@else-->
{@ $out_html = null;}
<!--@end-->
<td>{@ echo $out_html}</td><!--//(V560)-->
{@ $out_html = null;}
</tr>
<!--@end--><!--// end if 달력상 날자있으면-->
<!--@end--><!--// end for-->
<!--@end--><!--// end for-->
</tbody>
</table>
<!--@if($display_offset != $offset && $offset != null && $device != printer )--><!--// 사용자시간 출력 -->
<div class="client_time">
Server time is <font color='blue'>{date("l, F j, Y, g:i a", $display_timestamp)}</font>
and your time is <font color='blue'>{date("l, F j, Y, g:i a", $client_timestamp)}</font> : {($display_timestamp-$client_timestamp)*(-1)/3600}Hrs difference.
</div>
<!--@end-->
<!--@if($pOption_2 == 'W1' && $pTimeSchedule == 'Y' || $pOption_2 == 'W2' && $pTimeSchedule == 'Y')-->
<div class="Timetable_div" ID="Timetable_div" style="margin-top:20px;"></div><!--// time table 출력 -->
<!--@end-->
</div><!--// end class="planner123" -->
<!--@if($schedule_html)--><!--// jquery에서 사용할 스케쥴 어레이 정렬: 출력순서 조정위해 타입->날자->긴일정->시간 순서로 정렬 -->
{@ $schedule_html = planner123_widget_main::fn_array_orderby($schedule_html, 'segtype', SORT_ASC, 'date', SORT_ASC, 'revseq', SORT_ASC, 'pln_stime', SORT_ASC, 'pln_srl', SORT_DESC);}
<!--@end-->
<!--@if(!function_exists('json_encode'))--><!--// json_encode: PHP 5.2.0 부터지원 -->
{@
require_once($widget_path.'function/class.services_JSON.php');// 위젯
$json = new Services_JSON;
$schedule_html_json = $json->encode($schedule_html);
}
<!--@else-->
{@ $schedule_html_json = json_encode($schedule_html);}
<!--@end-->
<script type="text/javascript">
/* 일정 출력 */
var arrayFromPHP_list = {@ echo $schedule_html_json};  // PHP에서 만든 일정 어레이를 받아서(V560)
var repeat_style = "";
var ind_pOption_2 = "{$pOption_2}";
var ind_mobile = "{$ind_mobile}";
var dispStart_stamp = "{$dispStart_stamp}";
var dispEnd_stamp = "{$dispEnd_stamp}";
var dispStart_date = "{$dispStart_date}";
var dispEnd_date = "{$dispEnd_date}";
var ind_Timetable_list = "{$pTimeSchedule}"; // display time-table
var lang_type = "{$lang_type}";
var adjust_title_color = "{$adjust_title_color}";
jQuery(function($) {
if ($("#list_planner123").width()) {  // ( 조건 없으면 위젯 설치에서 문제발생)
$(document).ready(function() {
if ((ind_pOption_2 == 'W1' || ind_pOption_2 == 'W2')  && ind_Timetable_list == 'Y' ) {
fnMakeTableGrid(dispStart_date,dispEnd_date,ind_mobile,lang_type,"list"); // grid time table
fnMakeWeeklySchedule(arrayFromPHP_list,dispStart_stamp,dispEnd_stamp, "list");   // make schedule in the time table
fnAdjTimeTable("list");   // adjust time table header
}
});
}
});
</script>
